{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport useAxios from \"../hooks/useAxios\";\nimport { UserContext } from \"../../App\";\nimport * as SecureStore from 'expo-secure-store';\nfunction useEvent() {\n  var _useState = useState(),\n    _useState2 = _slicedToArray(_useState, 2),\n    allEventInOrder = _useState2[0],\n    setAllEventInOrder = _useState2[1];\n  var _useAxios = useAxios(),\n    callAxios = _useAxios.callAxios,\n    answerAxios = _useAxios.answerAxios;\n  var _useContext = useContext(UserContext),\n    dataUser = _useContext.dataUser,\n    profile = _useContext.profile,\n    setProfile = _useContext.setProfile;\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    returnedNextEvent = _useState4[0],\n    setReturnedNextEvent = _useState4[1];\n  var _useState5 = useState([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    returnedEventConclued = _useState6[0],\n    setReturnedEventConclued = _useState6[1];\n  var _useState7 = useState(),\n    _useState8 = _slicedToArray(_useState7, 2),\n    allEvents = _useState8[0],\n    setAllEvents = _useState8[1];\n  var _useState9 = useState(),\n    _useState10 = _slicedToArray(_useState9, 2),\n    returnedEventsOrderBy = _useState10[0],\n    setReturnedEventsOrderBy = _useState10[1];\n  function dataAtualFormatada() {\n    var data = new Date(),\n      dia = data.getDate().toString(),\n      diaF = dia.length == 1 ? '0' + dia : dia,\n      mes = (data.getMonth() + 1).toString(),\n      mesF = mes.length == 1 ? '0' + mes : mes,\n      anoF = data.getFullYear();\n    return diaF + \"-\" + mesF + \"-\" + anoF;\n  }\n  useEffect(function () {\n    getEvents();\n  }, []);\n  function getEvents() {\n    return _getEvents.apply(this, arguments);\n  }\n  function _getEvents() {\n    _getEvents = _asyncToGenerator(function* () {\n      var dataUser = yield SecureStore.getItemAsync('User');\n      var dataUserFilter = JSON.parse(dataUser);\n      var data = \"\";\n      try {\n        yield callAxios(\"calendar/\" + dataUserFilter.id, data, \"get\");\n      } catch (e) {\n        console.log(e);\n      }\n    });\n    return _getEvents.apply(this, arguments);\n  }\n  useEffect(function () {\n    if (answerAxios.res) {\n      if (answerAxios.res.length) {\n        setAllEvents(answerAxios.res);\n        if (answerAxios.delete) {\n          GetTests();\n        }\n        if (answerAxios.create || answerAxios.update) {\n          GetTests();\n        }\n      }\n    }\n  }, [answerAxios]);\n  useEffect(function () {\n    if (allEvents != undefined) {\n      returnedNextEvent.splice(0, returnedNextEvent.length);\n      returnedEventConclued.splice(0, returnedEventConclued.length);\n      AgroupDate();\n    }\n  }, [allEvents]);\n  function AgroupDate() {\n    return _AgroupDate.apply(this, arguments);\n  }\n  function _AgroupDate() {\n    _AgroupDate = _asyncToGenerator(function* () {\n      var arrayOfDatasDefault = [];\n      arrayOfDatasDefault.push(dataAtualFormatada());\n      answerAxios.res.map(function (data) {\n        arrayOfDatasDefault.push(data.date);\n      });\n      FormatDate(arrayOfDatasDefault);\n    });\n    return _AgroupDate.apply(this, arguments);\n  }\n  function FormatDate(arrayOfDatasDefault) {\n    var filtered = arrayOfDatasDefault.sort(function (a, b) {\n      var aa = a.split('-').reverse().join(),\n        bb = b.split('-').reverse().join();\n      return aa < bb ? -1 : aa > bb ? 1 : 0;\n    });\n    InsertNextEvent(filtered);\n    InsertEventConcluded(filtered);\n  }\n  function InsertNextEvent(filtered) {\n    var NoRepeat = 10;\n    var indexToday = filtered.indexOf(dataAtualFormatada());\n    var _loop = function _loop(i) {\n      var findedData = allEvents.findIndex(function (data) {\n        return data.date == filtered[i] && NoRepeat != data.id;\n      });\n      returnedNextEvent.push(answerAxios.res[findedData]);\n      NoRepeat = answerAxios.res[findedData].id;\n    };\n    for (var i = indexToday + 1; i < filtered.length; i++) {\n      _loop(i);\n    }\n  }\n  function InsertEventConcluded(filtered) {\n    var indexToday = filtered.indexOf(dataAtualFormatada());\n    var _loop2 = function _loop2(i) {\n      var findedData = answerAxios.res.find(function (data) {\n        return data.date == filtered[i];\n      });\n      returnedEventConclued.push(findedData);\n    };\n    for (var i = 0; i < indexToday; i++) {\n      _loop2(i);\n    }\n    setReturnedEventsOrderBy({\n      NextEvent: returnedNextEvent,\n      EventConclued: returnedEventConclued\n    });\n  }\n  var callEvent = React.useCallback(function () {\n    var _ref = _asyncToGenerator(function* (url, data, type) {\n      getEvents();\n    });\n    return function (_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n  return {\n    returnedEventsOrderBy: returnedEventsOrderBy,\n    callEvent: callEvent\n  };\n}\nexport default useEvent;","map":{"version":3,"names":["React","useState","useEffect","useContext","useAxios","UserContext","SecureStore","useEvent","_useState","_useState2","_slicedToArray","allEventInOrder","setAllEventInOrder","_useAxios","callAxios","answerAxios","_useContext","dataUser","profile","setProfile","_useState3","_useState4","returnedNextEvent","setReturnedNextEvent","_useState5","_useState6","returnedEventConclued","setReturnedEventConclued","_useState7","_useState8","allEvents","setAllEvents","_useState9","_useState10","returnedEventsOrderBy","setReturnedEventsOrderBy","dataAtualFormatada","data","Date","dia","getDate","toString","diaF","length","mes","getMonth","mesF","anoF","getFullYear","getEvents","_getEvents","apply","arguments","_asyncToGenerator","getItemAsync","dataUserFilter","JSON","parse","id","e","console","log","res","delete","GetTests","create","update","undefined","splice","AgroupDate","_AgroupDate","arrayOfDatasDefault","push","map","date","FormatDate","filtered","sort","a","b","aa","split","reverse","join","bb","InsertNextEvent","InsertEventConcluded","NoRepeat","indexToday","indexOf","_loop","i","findedData","findIndex","_loop2","find","NextEvent","EventConclued","callEvent","useCallback","_ref","url","type","_x","_x2","_x3"],"sources":["C:/Users/Lucas/Desktop/Projetos/Istudy/src/components/useEvent.jsx"],"sourcesContent":["import React, {useState, useEffect, useContext} from 'react';\nimport useAxios from '../hooks/useAxios';\nimport { UserContext } from '../../App';\nimport * as SecureStore from 'expo-secure-store';\n\n\n\nfunction useEvent() {\n  // Variavel de resposta do axios\n  const  [allEventInOrder, setAllEventInOrder] = useState()\n  const {callAxios, answerAxios} = useAxios()\n  const {dataUser, profile, setProfile} = useContext(UserContext)\n  const [returnedNextEvent, setReturnedNextEvent] = useState([])\n  const [returnedEventConclued, setReturnedEventConclued] = useState([])\n  const [allEvents, setAllEvents] = useState()\n  const [returnedEventsOrderBy, setReturnedEventsOrderBy] = useState()\n\n\n  \n\n  function dataAtualFormatada(){\n    var data = new Date(),\n        dia  = data.getDate().toString(),\n        diaF = (dia.length == 1) ? '0'+dia : dia,\n        mes  = (data.getMonth()+1).toString(), //+1 pois no getMonth Janeiro comeÃ§a com zero.\n        mesF = (mes.length == 1) ? '0'+mes : mes,\n        anoF = data.getFullYear();\n    return diaF+\"-\"+mesF+\"-\"+anoF;\n}\n\n  useEffect(() => {\n    getEvents()\n  },[])\n\n  async function getEvents() {\n    const dataUser=  await SecureStore.getItemAsync('User')\n    const dataUserFilter = (JSON.parse(dataUser));\n\n    var data = \"\"\n    try{\n      await callAxios (\"calendar/\" + dataUserFilter.id, data, \"get\")\n    }catch(e){\n        console.log(e)\n    }\n  }\n  useEffect( () => {\n    if(answerAxios.res){\n      if(answerAxios.res.length){\n        setAllEvents(answerAxios.res)\n        if(answerAxios.delete){\n          GetTests()\n        }\n        if(answerAxios.create || answerAxios.update) {\n         GetTests()\n        }\n      }\n    }\n  },[answerAxios])\n  \n  useEffect( () => {\n     if(allEvents != undefined) {\n      returnedNextEvent.splice(0, returnedNextEvent.length)\n      returnedEventConclued.splice(0, returnedEventConclued.length)\n       AgroupDate()\n     }\n  },[allEvents])\n\n\n  async function AgroupDate(){\n    const arrayOfDatasDefault = []\n    arrayOfDatasDefault.push(dataAtualFormatada())\n    answerAxios.res.map((data) => {\n      arrayOfDatasDefault.push(data.date)\n    })\n    FormatDate(arrayOfDatasDefault)\n  }\n\n  function FormatDate(arrayOfDatasDefault){\n    const filtered = arrayOfDatasDefault.sort(function(a, b){\n      var aa = a.split('-').reverse().join(),\n      bb = b.split('-').reverse().join();\n      return aa < bb ? -1 : (aa > bb ? 1 : 0);\n    });\n    InsertNextEvent(filtered)\n    InsertEventConcluded(filtered)\n  }\n\n  function InsertNextEvent(filtered){\n    var NoRepeat = 10\n    const indexToday = filtered.indexOf(dataAtualFormatada())\n\n    for(let i = indexToday + 1; i < filtered.length; i++) {\n      const findedData = allEvents.findIndex((data) => data.date == filtered[i] && NoRepeat != data.id) \n      returnedNextEvent.push(answerAxios.res[findedData])\n      NoRepeat = answerAxios.res[findedData].id\n    }\n  }\n\n\n  function InsertEventConcluded(filtered){\n    const indexToday = filtered.indexOf(dataAtualFormatada())\n\n    for(let i = 0 ; i < indexToday ; i++) {\n        const findedData = answerAxios.res.find((data) => data.date == filtered[i])\n        returnedEventConclued.push(findedData)\n    }\n    setReturnedEventsOrderBy({NextEvent: returnedNextEvent,  EventConclued: returnedEventConclued})\n  }\n\n  const callEvent = React.useCallback(async(url, data, type) =>{\n    getEvents()\n    })\n  return { \n    returnedEventsOrderBy,\n    callEvent\n  }\n}\nexport default useEvent\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}